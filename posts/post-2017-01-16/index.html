<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="/css/style.css"><link rel="icon" type="image/x-icon" href="/assets/images/favicon.png"><title>Word similarity using product discount data</title></head><body><main><header><nav><a class="avatar" href="/"><img src="/assets/images/avatar.png" alt="AB"></a><div class="anchor">/ <a href="/">abarmat.com</a> / <a href="/posts">posts</a></div></nav></header><div><div class="content post"><section><h1>Word similarity using product discountÂ data</h1><p>Among all the branches of machine learning I'm really interested in unsupervised learning, basically discovering structure in the data without any specific purpose. It is already being used as a way to &quot;bootstrap&quot; other models, extracting features from data and then using a supervised model to put labels on it using training examples.</p><p>Some months ago reading about different models I came across Word2vec. Word2vec is a model that let you learn features from text, created by Tomas Mikolov and his friends from Google and detailed in the paper <a href="http://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf">Distributed Representations of Words and Phrases and their Compositionality</a>. Some people say it's semi-supervised because it uses a target function to learn the context of every word in the corpus. It's based on a shallow neural network (1 hidden layer) which is really fast to train and gives you a matrix of M x N (M: vocabulary size and N: number of features). Studying the distance between different vectors that compose this matrix we can find which words are used in similar contexts.</p><p>I decided to give it a try with a dataset from <a href="http://oony.com">Oony</a>, a deal-aggregator service I created with <a href="https://ar.linkedin.com/in/chentschel">Cristian Hentschel</a>. We collected data from more than 150M coupons and products on discount published around the world. As the dataset is quite large I just used a subset from the <em>UK</em> and only in the <em>electronics &amp; technology</em> category.</p><p>Some characteristics about the dataset:</p><ul><li>1132643 records.</li><li>I used only the title and description field.</li><li>Title average length is 61 chars.</li><li>Description average length is 94 chars.</li></ul><p><img src="https://cdn-images-1.medium.com/max/800/1*5HbBubbVqIfpb3B6_ImtOA.png" alt=""> <sub>Example data</sub></p><p>Questions:</p><ul><li>Is there any structure in the data?</li><li>Will it work well with short titles and descriptions from deals?</li></ul><h2>Getting the word embedding</h2><ol><li>Ran a Python script to extract a text dump of title+description from a PostgreSQL database where all the deals are stored.</li><li>Stripped html tags, converted all to lowercase and removed stopwords using NLTK. Applied the Wordnet lemmatizer to reduce the vocabulary size.</li><li>Saved a 136MB file to disk with a concatenation of all the processed text.</li><li>I used Tensorflow with a modified version of the <a href="https://github.com/tensorflow/models/blob/master/tutorials/embedding/word2vec_optimized.py">word2vec_optimized</a> script, setting the window_size to 2 and embedding size to 200. (I also tried gensim but found the Tensorflow version faster).</li><li>The vocabulary size was of 131718 words and ran the training set for 15 epochs.</li></ol><p><img src="https://cdn-images-1.medium.com/max/1200/1*q9BGV6ksPL2d53r57MaOEg.png" alt=""> <sub>Word2vec using Tensorflow</sub></p><h2>Visualization</h2><p>As a result of processing the dataset through Word2vec I got a matrix of 131718 x 200. As it's high dimensional data and impossible to visualize I applied a <a href="https://lvdmaaten.github.io/tsne/">t-SNE</a> transformation to reduce the matrix and projecting it into a plane. I selected only the top 500 words by frequency from the vocabulary and ran the transformation with a perplexity of 30 and 5000 iterations (tried with different values to see what looked good). There's a good guide on interpreting t-SNE and its hyper-parameters on the &quot;interesting resources&quot; section below.</p><p><img src="https://cdn-images-1.medium.com/max/1200/1*d7Tp3qin4bCEK_wWUMP-pg.png" alt=""></p><h2>Conclusions</h2><p>From the chart we can see clumps of words which share similar contexts, for instance colors on the middle right side, computer parts on the top left, and electronic brands on the lower right. There's a bunch of selling/marketing words (perfect, unique, ideal, special, best, great, excellent) on the lower left.</p><p>Some applications of the embedding info I can think of are: using it for improving search relevance of related terms, creating relationship between different deals, identifying entities which can help tag different attributes of the deals and products.</p><p>Other experiments that would be nice to test are: trying with different embedding/window size, running the process without removing stopwords to see if it retains context information better, using a much larger dataset to see what structure emerge.</p><hr><h2>Interesting resources</h2><ul><li><p><a href="https://rare-technologies.com/word2vec-tutorial/" title="https://rare-technologies.com/word2vec-tutorial/">Word2vec Tutorial</a><a href="https://rare-technologies.com/word2vec-tutorial/"></a></p></li><li><p><a href="https://www.tensorflow.org/tutorials/word2vec/" title="https://www.tensorflow.org/tutorials/word2vec/">Vector Representations of Words | TensorFlow</a><a href="https://www.tensorflow.org/tutorials/word2vec/"></a></p></li><li><p><a href="http://distill.pub/2016/misread-tsne/" title="http://distill.pub/2016/misread-tsne/">How to Use t-SNE Effectively</a><a href="http://distill.pub/2016/misread-tsne/"></a></p></li></ul></section><sub>Published on <a href="https://medium.com/@abarmat/word-similarity-using-product-discount-data-2ec0b2ac993c">January 15, 2017</a></sub></div></div></main><footer></footer></body></html>